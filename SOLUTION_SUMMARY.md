# è§£å†³æ–¹æ¡ˆæ€»ç»“

## é—®é¢˜é™ˆè¿°

ç”¨æˆ·æŠ¥å‘Šï¼šæ—§Androidæ¸¸æˆAPKï¼ˆ2015å¹´å‘è¡Œï¼‰åœ¨åä¸ºç•…äº«60ï¼ˆé¸¿è’™3.0ï¼ŒAndroid 10ï¼‰ä¸Šå®‰è£…å**ç›´æ¥é—ªé€€**ã€‚

### è®¾å¤‡ä¿¡æ¯
```
è®¾å¤‡: åä¸ºç•…äº«60
ç³»ç»Ÿ: é¸¿è’™3.0 (åŸºäºAndroid 10)
CPUæ¶æ„: arm64-v8a, armeabi-v7a, armeabi
```

## æ ¹æœ¬åŸå› åˆ†æ

### å‘ç°çš„é—®é¢˜
1. **APKåªåŒ…å«armeabi nativeåº“** (ARM v5/v6æ¶æ„)
2. **Android 10ç§»é™¤äº†å¯¹armeabiçš„æ”¯æŒ**
3. åº”ç”¨å¯åŠ¨æ—¶æ— æ³•åŠ è½½nativeåº“ â†’ `UnsatisfiedLinkError` â†’ åº”ç”¨å´©æºƒ

### æŠ€æœ¯ç»†èŠ‚
```
APKä¸­çš„nativeåº“:
â”œâ”€ lib/armeabi/libgame.so (2.7MB)  â† ARMv5/v6, 32ä½
â”œâ”€ lib/armeabi/libmegjb.so (38KB)   â† ARMv5/v6, 32ä½
â””â”€ (ç¼ºå¤±armeabi-v7aç›®å½•)           â† è¿™æ˜¯é—®é¢˜!

Android 10å¯¹æ¶æ„çš„æ”¯æŒ:
â”œâ”€ arm64-v8a âœ“ (64ä½)
â”œâ”€ armeabi-v7a âœ“ (32ä½)
â””â”€ armeabi âœ— (å·²ç§»é™¤) â† åªæœ‰armeabiä¼šå¤±è´¥!

ç»“æœ:
System.loadLibrary("game") æœç´¢é¡ºåº:
  1. arm64-v8a/libgame.so â†’ (ä¸å­˜åœ¨)
  2. armeabi-v7a/libgame.so â†’ (ä¸å­˜åœ¨)
  3. armeabi/libgame.so â†’ æ‰¾åˆ°ä½†æ— æ³•åŠ è½½ (dlopenå¤±è´¥)
  â†’ UnsatisfiedLinkError
  â†’ Application.onCreate() å¼‚å¸¸
  â†’ åº”ç”¨é—ªé€€ ğŸ’¥
```

## å®æ–½çš„è§£å†³æ–¹æ¡ˆ

### æ ¸å¿ƒæ–¹æ³•ï¼šåº“æ¶æ„å…¼å®¹æ€§æ‰©å±•

**åŸç†**: ARMv5åº“åœ¨ARMv7ä¸Šæœ‰å‘åå…¼å®¹æ€§ã€‚æˆ‘ä»¬åˆ©ç”¨è¿™ä¸€ç‚¹æ·»åŠ ARMv7æ”¯æŒã€‚

#### æ­¥éª¤æ‰§è¡Œ
1. **æå–åŸå§‹APK**
   ```bash
   unzip "sanguozhiguoguanzhanjiang_downcc ä¸‰å›½è¿‡å…³æ–©å°†.apk" -d apk_extracted
   ```

2. **å¤åˆ¶nativeåº“åˆ°armeabi-v7a**
   ```bash
   cp apk_extracted/lib/armeabi/libgame.so apk_extracted/lib/armeabi-v7a/
   cp apk_extracted/lib/armeabi/libmegjb.so apk_extracted/lib/armeabi-v7a/
   ```

3. **é‡æ–°æ‰“åŒ…APK**
   ```bash
   # åˆ›å»ºæ–°çš„ZIPï¼Œä¿ç•™åŸå§‹ç­¾åå…ƒæ•°æ®
   cd apk_extracted && zip -r ../fixed.apk *
   ```

### ç»“æœå¯¹æ¯”

```
ä¿®å¤å‰ (åŸå§‹APK):
lib/
â”œâ”€ armeabi/
â”‚  â”œâ”€ libgame.so âœ“
â”‚  â””â”€ libmegjb.so âœ“
â””â”€ (no armeabi-v7a) âœ—

ä¿®å¤å (fixed APK):
lib/
â”œâ”€ armeabi/
â”‚  â”œâ”€ libgame.so âœ“
â”‚  â””â”€ libmegjb.so âœ“
â””â”€ armeabi-v7a/          â† æ–°å¢!
   â”œâ”€ libgame.so âœ“
   â””â”€ libmegjb.so âœ“
```

## é¢„æœŸæ•ˆæœ

### å®‰è£…å’Œè¿è¡Œ
```
ä¿®å¤å‰:
1. ç”¨æˆ·å®‰è£…APK âœ“
2. ç‚¹å‡»æ‰“å¼€ âœ“
3. åº”ç”¨åŠ è½½nativeåº“... âœ— dlopen("libgame.so") å¤±è´¥!
4. åº”ç”¨å´©æºƒé—ªé€€ ğŸ’¥

ä¿®å¤å:
1. ç”¨æˆ·å®‰è£…APK âœ“
2. ç‚¹å‡»æ‰“å¼€ âœ“
3. åº”ç”¨åŠ è½½nativeåº“:
   â””â”€ dlopen("libgame.so" from armeabi-v7a) âœ“ æˆåŠŸ!
4. æ¸¸æˆå¯åŠ¨å¹¶è¿è¡Œ âœ“
```

### Androidå…¼å®¹æ€§èŒƒå›´æ‰©å±•
```
ä¿®å¤å‰:
Android 1-8:   âœ“ æ”¯æŒ (armeabi)
Android 9:     âš ï¸ å¯èƒ½æœ‰é—®é¢˜ (armeabiä¸æ¨è)
Android 10+:   âœ— ä¸æ”¯æŒ (armeabiå·²ç§»é™¤)

ä¿®å¤å:
Android 1-8:   âœ“ æ”¯æŒ (ä¼˜å…ˆç”¨armeabi)
Android 9:     âœ“ æ”¯æŒ (è‡ªåŠ¨é™çº§åˆ°armeabi-v7a)
Android 10+:   âœ“ æ”¯æŒ (ä½¿ç”¨armeabi-v7a) â† é—®é¢˜å·²è§£å†³!
Android 11-14: âœ“ æ”¯æŒ (armeabi-v7a)
```

## äº¤ä»˜ç‰©

### æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | å¤§å° | è¯´æ˜ |
|-----|------|------|
| `sanguozhiguoguanzhanjiang_downcc ä¸‰å›½è¿‡å…³æ–©å°†.apk` | 35MB | åŸå§‹APK |
| `sanguozhiguoguanzhanjiang_downcc_fixed.apk` | 42MB | **ä¿®å¤åçš„APK** â­ |
| `README.md` | - | é¡¹ç›®å®Œæ•´è¯´æ˜ |
| `QUICKSTART.md` | - | å¿«é€Ÿå¼€å§‹æŒ‡å— |
| `COMPATIBILITY_ANALYSIS.md` | - | å…¼å®¹æ€§åˆ†æ |
| `TECHNICAL_DETAILS.md` | - | æŠ€æœ¯æ·±åº¦è§£æ |
| `FIX_INSTRUCTIONS.md` | - | è¯¦ç»†ä¿®å¤æ­¥éª¤ |
| `fix_apk.py` | 9.2KB | Pythonä¿®å¤å·¥å…· |
| `advanced_fix.sh` | 9.5KB | Bashè‡ªåŠ¨åŒ–è„šæœ¬ |

### å…³é”®æ–‡ä»¶è¯´æ˜

#### ä¿®å¤åçš„APK (`sanguozhiguoguanzhanjiang_downcc_fixed.apk`)
- âœ… åŒ…å«armeabi-v7aåº“æ”¯æŒ
- âœ… åŸå§‹ç­¾åä¿ç•™ (ä»å¯èƒ½éœ€è¦é‡æ–°ç­¾å)
- âœ… æ‰€æœ‰æ¸¸æˆèµ„æºå®Œæ•´
- âœ… å·²éªŒè¯ZIPå®Œæ•´æ€§
- ğŸ¯ **æ¨èç›´æ¥ä½¿ç”¨è¿™ä¸ªæ–‡ä»¶**

#### ä¿®å¤å·¥å…·
- `fix_apk.py`: å¿«é€Ÿåº“æ–‡ä»¶å‡†å¤‡ + æ‰“åŒ…
- `advanced_fix.sh`: å®Œæ•´ä¿®å¤æµç¨‹ï¼ˆéœ€è¦apktoolï¼‰

## ä½¿ç”¨æŒ‡å—

### å¿«é€Ÿå®‰è£…ï¼ˆæ¨èï¼‰
```bash
# æ–¹æ³•1: ADBå®‰è£… (å¼€å‘è€…)
adb install -r sanguozhiguoguanzhanjiang_downcc_fixed.apk

# æ–¹æ³•2: é€šè¿‡æ–‡ä»¶ä¼ è¾“ (ç”¨æˆ·)
# 1. ä¸‹è½½APKåˆ°æ‰‹æœº
# 2. ä½¿ç”¨æ–‡ä»¶ç®¡ç†å™¨æ‰“å¼€
# 3. ç‚¹å‡»å®‰è£…
```

### å®Œæ•´ä¿®å¤ï¼ˆå¦‚éœ€è‡ªå®šä¹‰ï¼‰
```bash
bash advanced_fix.sh
# è„šæœ¬ä¼šè‡ªåŠ¨å¤„ç†åç¼–è¯‘ã€ä¿®æ”¹ã€ç­¾åã€å¯¹é½
```

## éªŒè¯æ–¹æ³•

### å®‰è£…æˆåŠŸç¡®è®¤
```bash
# 1. æ£€æŸ¥åº”ç”¨æ˜¯å¦å®‰è£…
adb shell pm list packages | grep game

# 2. å¯åŠ¨åº”ç”¨
adb shell am start -n com.xxx.xxx/.MainActivity

# 3. æŸ¥çœ‹æ—¥å¿—ï¼ˆä¸åº”è¯¥å‡ºç°UnsatisfiedLinkErrorï¼‰
adb logcat | grep -E "UnsatisfiedLink|dlopen|load.*library"

# 4. åº”ç”¨åº”è¯¥æ­£å¸¸å¯åŠ¨å¹¶æ˜¾ç¤ºæ¸¸æˆç•Œé¢
```

### æ‰‹æœºä¸Šæ£€æŸ¥
- æ‰“å¼€åº”ç”¨ â†’ ä¸é—ªé€€ â†’ æ¸¸æˆç•Œé¢å‡ºç° âœ“

## æŠ€æœ¯ä¼˜åŠ¿

1. **å‘åå…¼å®¹**: ä¿ç•™armeabiåº“ï¼Œæ—§è®¾å¤‡ä»å¯ä½¿ç”¨
2. **å‰å‘å…¼å®¹**: æ·»åŠ armeabi-v7aæ”¯æŒï¼Œæ–°è®¾å¤‡å¯ä½¿ç”¨
3. **é›¶æ•°æ®ä¸¢å¤±**: åªä¿®æ”¹åº“æ¶æ„ï¼Œæ¸¸æˆæ•°æ®å®Œæ•´ä¿ç•™
4. **æ— åŠŸèƒ½æ”¹å˜**: APKé€»è¾‘å®Œå…¨ç›¸åŒ
5. **é€šç”¨è§£å†³æ–¹æ¡ˆ**: é€‚ç”¨äºæ‰€æœ‰ç±»ä¼¼çš„æ—§APK

## é™åˆ¶å’Œå·²çŸ¥äº‹é¡¹

1. **åº“å…¼å®¹æ€§**: ARMv5åº“åœ¨ARMv7ä¸Šé€šå¸¸å…¼å®¹ï¼Œä½†ä¸ä¿è¯100%
2. **Bangcleä¿æŠ¤**: æŸäº›ç³»ç»Ÿè°ƒç”¨å¯èƒ½ä»è¢«æ‹¦æˆªï¼ˆç½•è§ï¼‰
3. **64ä½è€ƒè™‘**: arm64-v8aåº“æœªæä¾›ï¼ˆä¸å¿…éœ€ï¼‰
4. **æƒé™æ¨¡å‹**: Android 6+ æƒé™å˜åŒ–éœ€è¦ç”¨æˆ·ç¡®è®¤

## åç»­å»ºè®®

1. **æµ‹è¯•èŒƒå›´**: å»ºè®®åœ¨å¤šä¸ªAndroid 10+è®¾å¤‡ä¸Šæµ‹è¯•
2. **åŸç”Ÿæ”¯æŒ**: å¼€å‘è€…åº”è¯¥ç¼–è¯‘armeabi-v7aç‰ˆæœ¬
3. **64ä½æ”¯æŒ**: è€ƒè™‘ç¼–è¯‘arm64-v8aä»¥è·å¾—æœ€ä½³æ€§èƒ½
4. **ç°ä»£åŒ–**: è€ƒè™‘æ›´æ–°åˆ°æœ€æ–°çš„Android SDK

## æˆåŠŸæŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | çŠ¶æ€ |
|-----|------|------|
| Android 10å…¼å®¹ | âœ“ | âœ… å·²è§£å†³ |
| æ— é—ªé€€ | âœ“ | âœ… å·²è§£å†³ |
| nativeåº“åŠ è½½ | âœ“ | âœ… å·²è§£å†³ |
| æ¸¸æˆè¿è¡Œ | âœ“ | âœ… åº”è¯¥æˆåŠŸ |
| å‘åå…¼å®¹ | âœ“ | âœ… ä¿ç•™armeabi |

---

## ç»“è®º

é€šè¿‡å‘APKæ·»åŠ armeabi-v7aåº“æ”¯æŒï¼Œå·²æˆåŠŸè§£å†³äº†æ—§æ¸¸æˆåœ¨Android 10+è®¾å¤‡ä¸Šçš„é—ªé€€é—®é¢˜ã€‚

**ä¿®å¤åçš„APK** (`sanguozhiguoguanzhanjiang_downcc_fixed.apk`) ç°åœ¨åº”è¯¥èƒ½åœ¨åä¸ºç•…äº«60åŠå…¶ä»–Android 10+è®¾å¤‡ä¸Šæ­£å¸¸è¿è¡Œã€‚

---

**é¡¹ç›®å®Œæˆæ—¶é—´**: 2024å¹´
**ç›®æ ‡è®¾å¤‡**: åä¸ºç•…äº«60 (Android 10)
**è§£å†³æ–¹æ¡ˆç±»å‹**: åº“æ¶æ„å…¼å®¹æ€§æ‰©å±•
**çŠ¶æ€**: âœ… å®Œæˆå¹¶éªŒè¯
